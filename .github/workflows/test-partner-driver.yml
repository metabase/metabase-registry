name: Test Partner Driver

on: push

jobs:
  clickhouse:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Metabase Registry Repo
        uses: actions/checkout@v3
        with:
          path: registry
      - name: Test Driver
        uses: registry/.github/actions/test-partner
        with:
          DRIVER: 'clickhouse'
          OP_SERVICE_ACCOUNT_TOKEN: ${{ secrets.OP_SERVICE_ACCOUNT_TOKEN }}
          MB_VERSION: 'master'
          REPO: ClickHouse/metabase-clickhouse-driver

  materialize:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Metabase Registry Repo
        uses: actions/checkout@v3
        with:
          path: registry
      - name: Test Driver
        uses: registry/.github/actions/test-partner
        with:
          DRIVER: 'materialize'
          OP_SERVICE_ACCOUNT_TOKEN: ${{ secrets.OP_SERVICE_ACCOUNT_TOKEN }}
          MB_VERSION: 'master'
          REPO: MaterializeInc/metabase-materialize-driver
